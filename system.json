{
  "Category": "System",
  "Calling convention": "WINAPI",

  "GetModuleHandleW": {
    "Signature": {
      "Library": "kernel32.dll",
      "Return": "HMODULE",
      "Feature": "P60"
    },

    "Parameters": {
      "lpModuleName": "LPCWSTR"
    },

    "PreLog": [
      "lpModuleName"
    ],

    "PostLog": [
      "Return"
    ]
  },

  "GetProcAddress": {
    "Signature": {
      "Library": "kernel32.dll",
      "Return": "FARPROC",
      "Feature": "P61"
    },

    "Parameters": {
      "hModule": "HMODULE",
      "lpProcName": "LPCSTR"
    }
  },

  "NtQuerySystemInformation": {
    "Signature": {
      "Library": "ntdll.dll",
      "Return": "NTSTATUS",
      "Feature": "P63"
    },

    "Parameters": {
      "SystemInformationClass": "SYSTEM_INFORMATION_CLASS",
      "SystemInformation": "LPVOID",
      "SystemInformationLength": "ULONG",
      "ReturnLength": "LPULONG"
    },

    "PreLog": [
      "SystemInformationClass"
    ],

    "PostCheck": {
      "0": {
        "Define": {
          "SystemInformation": "SYSTEM_BASIC_INFORMATION*"
        },

        "Check": {
          "SystemInformationClass": "%var0 == 'SystemBasicInformation'",
          "SystemInformation->NumberOfProcessors": "%var1 < 2"
        },

        "Modify": {
          "SystemInformation->NumberOfProcessors": "%var2 = 2"
        }
      }
    }
  }
}