{
  "Category": "System",
  "Calling convention": "WINAPI",

  "GetModuleHandleW": {
    "Signature": {
      "Library": "kernel32.dll",
      "Return": "HMODULE",
      "Feature": "P60"
    },

    "Parameters": {
      "lpModuleName": "LPCWSTR"
    },

    "PreLog": [
      "lpModuleName"
    ],

    "PostLog": [
      "Return"
    ]
  },

  "GetProcAddress": {
    "Signature": {
      "Library": "kernel32.dll",
      "Return": "FARPROC",
      "Feature": "P61"
    },

    "Parameters": {
      "hModule": "HMODULE",
      "lpProcName": "LPCSTR"
    }
  },

  "NtQuerySystemInformation": {
    "Signature": {
      "Library": "ntdll.dll",
      "Return": "NTSTATUS",
      "Feature": "P63"
    },

    "Parameters": {
      "SystemInformationClass": "SYSTEM_INFORMATION_CLASS",
      "SystemInformation": "LPVOID",
      "SystemInformationLength": "ULONG",
      "ReturnLength": "LPULONG"
    },

    "PreLog": [
      "SystemInformationClass"
    ],

    "PostCheck": {
      "0": {
        "Define": {
          "SystemInformation": "SYSTEM_BASIC_INFORMATION*"
        },

        "Check": {
          "SystemInformationClass": "%var0 == 'SystemBasicInformation'",
          "SystemInformation->NumberOfProcessors": "%var1 < 2"
        },

        "Modify": {
          "SystemInformation->NumberOfProcessors": "%var2 = 2"
        }
      }
    }
  },

  "NtQueryLicenseValue": {
    "Signature": {
      "Library": "ntdll.dll",
      "Return": "NTSTATUS",
      "Feature": "P65"
    },

    "Parameters": {
      "ValueName": "LPUNICODE_STRING",
      "Type": "LPULONG",
      "Data": "LPVOID",
      "DataSize": "ULONG",
      "ResultDataSize": "LPULONG"
    },

    "Ensure": [
      "ValueName"
    ],

    "PreLog": [
      "ValueName->Buffer"
    ],

    "PreCheck": {
      "0": {
        "Check": {
          "ValueName->Buffer": "%var0 =~ '^(?i)kernel-vmdetection-private$'"
        },

        "Modify": {
          "Return": "%var1 = 3221225524"
        }
      }
    }
  },

  "GetPwrCapabilities": {
    "Signature": {
      "Library": "PowrProf.dll",
      "Return": "BYTE",
      "Feature": "P66"
    },
    "Parameters": {
      "lpspc": "LPSYSTEM_POWER_CAPABILITIES"
    },
    "Ensure": [
      "lpspc"
    ],
    "PostCheck": {
      "0": {
        "Check": {
          "lpspc->SystemS1": "%var0 == 0"
        },

        "Modify": {
          "lpspc->SystemS1": "%var1 = 1"
        }
      }
    }
  }
}